(function(){var requirejs,require,define;(function(t){function e(t,e){return g.call(t,e)}function n(t,e){var n,r,o,i,s,a,u,c,p,f,l=e&&e.split("/"),_=h.map,d=_&&_["*"]||{};if(t&&"."===t.charAt(0))if(e){for(l=l.slice(0,l.length-1),t=l.concat(t.split("/")),c=0;t.length>c;c+=1)if(f=t[c],"."===f)t.splice(c,1),c-=1;else if(".."===f){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((l||d)&&_){for(n=t.split("/"),c=n.length;c>0;c-=1){if(r=n.slice(0,c).join("/"),l)for(p=l.length;p>0;p-=1)if(o=_[l.slice(0,p).join("/")],o&&(o=o[r])){i=o,s=c;break}if(i)break;!a&&d&&d[r]&&(a=d[r],u=c)}!i&&a&&(i=a,s=u),i&&(n.splice(0,s,i),t=n.join("/"))}return t}function r(e,n){return function(){return p.apply(t,v.call(arguments,0).concat([e,n]))}}function o(t){return function(e){return n(e,t)}}function i(t){return function(e){_[t]=e}}function s(n){if(e(d,n)){var r=d[n];delete d[n],y[n]=!0,c.apply(t,r)}if(!e(_,n)&&!e(y,n))throw Error("No "+n);return _[n]}function a(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function u(t){return function(){return h&&h.config&&h.config[t]||{}}}var c,p,f,l,_={},d={},h={},y={},g=Object.prototype.hasOwnProperty,v=[].slice;f=function(t,e){var r,i=a(t),u=i[0];return t=i[1],u&&(u=n(u,e),r=s(u)),u?t=r&&r.normalize?r.normalize(t,o(e)):n(t,e):(t=n(t,e),i=a(t),u=i[0],t=i[1],u&&(r=s(u))),{f:u?u+"!"+t:t,n:t,pr:u,p:r}},l={require:function(t){return r(t)},exports:function(t){var e=_[t];return e!==void 0?e:_[t]={}},module:function(t){return{id:t,uri:"",exports:_[t],config:u(t)}}},c=function(n,o,a,u){var c,p,h,g,v,x,m=[];if(u=u||n,"function"==typeof a){for(o=!o.length&&a.length?["require","exports","module"]:o,v=0;o.length>v;v+=1)if(g=f(o[v],u),p=g.f,"require"===p)m[v]=l.require(n);else if("exports"===p)m[v]=l.exports(n),x=!0;else if("module"===p)c=m[v]=l.module(n);else if(e(_,p)||e(d,p)||e(y,p))m[v]=s(p);else{if(!g.p)throw Error(n+" missing "+p);g.p.load(g.n,r(u,!0),i(p),{}),m[v]=_[p]}h=a.apply(_[n],m),n&&(c&&c.exports!==t&&c.exports!==_[n]?_[n]=c.exports:h===t&&x||(_[n]=h))}else n&&(_[n]=a)},requirejs=require=p=function(e,n,r,o,i){return"string"==typeof e?l[e]?l[e](n):s(f(e,n).f):(e.splice||(h=e,n.splice?(e=n,n=r,r=null):e=t),n=n||function(){},"function"==typeof r&&(r=o,o=i),o?c(t,e,n,r):setTimeout(function(){c(t,e,n,r)},4),p)},p.config=function(t){return h=t,h.deps&&p(h.deps,h.callback),p},define=function(t,n,r){n.splice||(r=n,n=[]),e(_,t)||e(d,t)||(d[t]=[t,n,r])},define.amd={jQuery:!0}})(),define("../components/almond/almond",function(){});var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};define("exception",[],function(){var t;return t=function(t){function e(t,e,n,r){this.message=t,this.code=e,this.details=n,this.data=r}return __extends(e,t),e}(Error)});var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};define("exceptions/data_object_invalid_json",["exception"],function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e}(t)});var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};define("exceptions/duplicated_distinct_ids",["exception"],function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e}(t)});var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};define("exceptions/internal_service_error",["exception"],function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e}(t)});var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};define("exceptions/invalid_token",["exception"],function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e}(t)});var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};define("exceptions/missing_parameter",["exception"],function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e}(t)});var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};define("exceptions/person_not_found",["exception"],function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e}(t)});var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};define("exceptions/properties_object_invalid",["exception"],function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e}(t)});var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};define("exceptions/revenue_property_invalid",["exception"],function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e}(t)});var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};define("exceptions/route_not_found",["exception"],function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e}(t)});var __hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};define("exceptions/timeout",["exception"],function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e}(t)}),define("exceptions/unknown",["exception"],function(){var t;return t=function(){function t(t,e,n,r){this.message=t,this.code=e,this.details=n,this.data=r}return t}()}),define("exceptions",["exception","exceptions/data_object_invalid_json","exceptions/duplicated_distinct_ids","exceptions/internal_service_error","exceptions/invalid_token","exceptions/missing_parameter","exceptions/person_not_found","exceptions/properties_object_invalid","exceptions/revenue_property_invalid","exceptions/route_not_found","exceptions/timeout","exceptions/unknown"],function(t,e,n,r,o,i,s,a,u,c,p,f){return{Exception:t,DataObjectInvalidJson:e,DuplicatedDistinctIds:n,InternalServiceError:r,InvalidToken:o,MissingParameter:i,PersonNotFound:s,PropertiesObjectInvalid:a,RevenuePropertyInvalid:u,RouteNotFound:c,Timeout:p,Unknown:f}}),"object"!=typeof JSON&&(JSON={}),function(){function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,r,o,i,s,a=gap,u=e[t];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(t)),"function"==typeof rep&&(u=rep.call(e,t,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?u+"":"null";case"boolean":case"null":return u+"";case"object":if(!u)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(u)){for(i=u.length,n=0;i>n;n+=1)s[n]=str(n,u)||"null";return o=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,o}if(rep&&"object"==typeof rep)for(i=rep.length,n=0;i>n;n+=1)"string"==typeof rep[n]&&(r=rep[n],o=str(r,u),o&&s.push(quote(r)+(gap?": ":":")+o));else for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(o=str(r,u),o&&s.push(quote(r)+(gap?": ":":")+o));return o=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var n,r,o=t[e];if(o&&"object"==typeof o)for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(r=walk(o,n),void 0!==r?o[n]=r:delete o[n]);return reviver.call(t,e,o)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("json2",function(t){return function(){var e;return e||t.JSON}}(this)),function(t){function e(e){function n(){}function r(){for(var t,e={shadowedProps:u,arrays:"isArray(iterable)",bottom:"",init:"iterable",loop:"",top:"",useHas:!0,useKeys:!!ee},r=0;t=arguments[r];r++)for(var o in t)e[o]=t[o];var i=e.args;e.firstArg=/^[^,]+/.exec(i)[0];var s=Function("hasOwnProperty, isArguments, isArray, isString, keys, lodash, objectTypes","return function("+i+") {\n"+V(e)+"\n}");return s(L,b,k,S,ee,n,v)}function o(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}function m(t){var e=!1;if(!t||B.call(t)!=h||!Z.argsClass&&b(t))return e;var n=t.constructor;return(O(n)?n instanceof n:Z.nodeClass||!o(t))?Z.ownLast?(re(t,function(t,n,r){return e=L.call(r,n),!1}),e===!0):(re(t,function(t,n){e=n}),e===!1||L.call(t,e)):e}function b(t){return B.call(t)==c}function k(t){return Z.argsObject&&t instanceof Array||(z?z(t):B.call(t)==p)}function w(t){return t===!0||t===!1||B.call(t)==f}function j(t,e,r,s,a,u){var _=r===i;if("function"==typeof r&&!_){r=n.createCallback(r,s,2);var v=r(t,e);if(v!==undefined)return!!v}if(t===e)return 0!==t||1/t==1/e;var x=typeof t,m=typeof e;if(t===t&&(!t||"function"!=x&&"object"!=x)&&(!e||"function"!=m&&"object"!=m))return!1;if(null==t||null==e)return t===e;var k=B.call(t),w=B.call(e);if(k==c&&(k=h),w==c&&(w=h),k!=w)return!1;switch(k){case f:case l:return+t==+e;case d:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case y:case g:return t==e+""}var P=k==p;if(!P){if(L.call(t,"__wrapped__ ")||L.call(e,"__wrapped__"))return j(t.__wrapped__||t,e.__wrapped__||e,r,s,a,u);if(k!=h||!Z.nodeClass&&(o(t)||o(e)))return!1;var S=!Z.argsObject&&b(t)?Object:t.constructor,A=!Z.argsObject&&b(e)?Object:e.constructor;if(S!=A&&!(O(S)&&S instanceof S&&O(A)&&A instanceof A))return!1}a||(a=[]),u||(u=[]);for(var E=a.length;E--;)if(a[E]==t)return u[E]==e;var C=0;if(v=!0,a.push(t),u.push(e),P){if(E=t.length,C=e.length,v=C==t.length,!v&&!_)return v;for(;C--;){var T=E,N=e[C];if(_)for(;T--&&!(v=j(t[T],N,r,s,a,u)););else if(!(v=j(t[C],N,r,s,a,u)))break}return v}return re(e,function(e,n,o){return L.call(o,n)?(C++,v=L.call(t,n)&&j(t[n],e,r,s,a,u)):undefined}),v&&!_&&re(t,function(t,e,n){return L.call(n,e)?v=--C>-1:undefined}),v}function O(t){return"function"==typeof t}function P(t){return t?v[typeof t]:!1}function S(t){return"string"==typeof t||B.call(t)==g}function A(t){return t===undefined}function E(t,e,r){var o=arguments,s=0,a=2;if(!P(t))return t;if(r===i)var u=o[3],c=o[4],p=o[5];else c=[],p=[],"number"!=typeof r&&(a=o.length),a>3&&"function"==typeof o[a-2]?u=n.createCallback(o[--a-1],o[a--],2):a>2&&"function"==typeof o[a-1]&&(u=o[--a]);for(;a>++s;)(k(o[s])?C:oe)(o[s],function(e,n){var r,o,s=e,a=t[n];if(e&&((o=k(e))||ie(e))){for(var f=c.length;f--;)if(r=c[f]==e){a=p[f];break}if(!r){var l;u&&(s=u(a,e),(l=s!==undefined)&&(a=s)),l||(a=o?k(a)?a:[]:ie(a)?a:{}),c.push(e),p.push(a),l||(a=E(a,e,i,u,c,p))}}else u&&(s=u(a,e),s===undefined&&(s=e)),s!==undefined&&(a=s);t[n]=a});return t}function C(t,e,n){if(e&&n===undefined&&k(t))for(var r=-1,o=t.length;o>++r&&e(t[r],r,t)!==!1;);else ne(t,e,n);return t}function T(t,e,n){var r=-1,o=t?t.length:0;if("number"==typeof n)r=(0>n?Y(0,o+n):n||0)-1;else if(n)return r=N(t,e),t[r]===e?r:-1;for(;o>++r;)if(t[r]===e)return r;return-1}function N(t,e,r,o){var i=0,s=t?t.length:i;for(r=r?n.createCallback(r,o,1):M,e=r(e);s>i;){var a=i+s>>>1;e>r(t[a])?i=a+1:s=a}return i}function I(){return e._=D,this}function q(t,e,r,o){var i=-1,u=t?t.length:0,c=[],p=c;"boolean"!=typeof e&&null!=e&&(o=r,r=e,e=!1);var f=!e&&u>=a;if(f)var l={};for(null!=r&&(p=[],r=n.createCallback(r,o));u>++i;){var _=t[i],d=r?r(_,i,t):_;if(f)var h=s+d,y=l[h]?!(p=l[h]):p=l[h]=[];(e?!i||p[p.length-1]!==d:y||0>T(p,d))&&((r||f)&&p.push(d),c.push(_))}return c}function J(t,e,n){if(null==t)return M;var r=typeof t;if("function"!=r){if("object"!=r)return function(e){return e[t]};var o=ee(t);return function(e){for(var n=o.length,r=!1;n--&&(r=j(e[o[n]],t[o[n]],i)););return r}}return e!==undefined?1===n?function(n){return t.call(e,n)}:2===n?function(n,r){return t.call(e,n,r)}:4===n?function(n,r,o,i){return t.call(e,n,r,o,i)}:function(n,r,o){return t.call(e,n,r,o)}:t}function M(t){return t}e=e?x.defaults(t.Object(),e,x.pick(t,contextProps)):t;var U=[],R={},D=t._,F=RegExp("^"+(R.valueOf+"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),H=(Math.ceil,t.clearTimeout,U.concat,Math.floor,F.test(H=Object.getPrototypeOf)&&H),L=R.hasOwnProperty,B=(U.push,t.setTimeout,R.toString),$=F.test($=B.bind)&&$,z=F.test(z=Array.isArray)&&z,K=(t.isFinite,t.isNaN,F.test(K=Object.keys)&&K),Y=Math.max;Math.min,Math.random,U.slice;var G=F.test(t.attachEvent),Q=$&&!/\n|true/.test($+G),Z=n.support={};(function(){var t=function(){this.x=1},e=[];t.prototype={valueOf:1,y:1};for(var n in new t)e.push(n);for(n in arguments);Z.argsObject=arguments.constructor==Object&&!(arguments instanceof Array),Z.argsClass=b(arguments),Z.enumPrototypes=t.propertyIsEnumerable("prototype"),Z.fastBind=$&&!Q,Z.ownLast="x"!=e[0],Z.nonEnumArgs=0!=n,Z.nonEnumShadows=!/valueOf/.test(e),Z.unindexedChars="xx"!="x"[0]+Object("x")[0];try{Z.nodeClass=!(B.call(document)==h&&!({toString:0}+""))}catch(r){Z.nodeClass=!0}})(1);var V=function(t){var e="var index, iterable = "+t.firstArg+", result = "+t.init+";\nif (!iterable) return result;\n"+t.top+";\n";if(t.arrays?(e+="var length = iterable.length; index = -1;\nif ("+t.arrays+") {  ",Z.unindexedChars&&(e+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),e+="\n  while (++index < length) {\n    "+t.loop+"\n  }\n}\nelse {  "):Z.nonEnumArgs&&(e+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+t.loop+"\n    }\n  } else {  "),Z.enumPrototypes&&(e+="\n  var skipProto = typeof iterable == 'function';\n  "),t.useHas&&t.useKeys)e+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] ? keys(iterable) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    ",Z.enumPrototypes&&(e+="if (!(skipProto && index == 'prototype')) {\n  "),e+=t.loop,Z.enumPrototypes&&(e+="}\n"),e+="  }  ";else if(e+="\n  for (index in iterable) {",(Z.enumPrototypes||t.useHas)&&(e+="\n    if (",Z.enumPrototypes&&(e+="!(skipProto && index == 'prototype')"),Z.enumPrototypes&&t.useHas&&(e+=" && "),t.useHas&&(e+="hasOwnProperty.call(iterable, index)"),e+=") {    "),e+=t.loop+";    ",(Z.enumPrototypes||t.useHas)&&(e+="\n    }"),e+="\n  }    ",Z.nonEnumShadows){e+="\n\n  var ctor = iterable.constructor;\n      ";for(var n=0;7>n;n++)e+="\n  index = '"+t.shadowedProps[n]+"';\n  if (","constructor"==t.shadowedProps[n]&&(e+="!(ctor && ctor.prototype === iterable) && "),e+="hasOwnProperty.call(iterable, index)) {\n    "+t.loop+"\n  }      "}return(t.arrays||Z.nonEnumArgs)&&(e+="\n}"),e+=t.bottom+";\nreturn result"},W={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : lodash.createCallback(callback, thisArg)",arrays:"typeof length == 'number'",loop:"if (callback(iterable[index], index, collection) === false) return result"},X={top:"if (!objectTypes[typeof iterable]) return result;\n"+W.top,arrays:!1};Z.argsClass||(b=function(t){return t?L.call(t,"callee"):!1});var te=r({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)",arrays:!1}),ee=K?function(t){return P(t)?Z.enumPrototypes&&"function"==typeof t||Z.nonEnumArgs&&t.length&&b(t)?te(t):K(t):[]}:te,ne=r(W),re=r(W,X,{useHas:!1}),oe=r(W,X);O(/x/)&&(O=function(t){return t instanceof Function||B.call(t)==_});var ie=H?function(t){if(!t||B.call(t)!=h||!Z.argsClass&&b(t))return!1;var e=t.valueOf,n="function"==typeof e&&(n=H(e))&&H(n);return n?t==n||H(t)==n:m(t)}:m;return n.createCallback=J,n.forEach=C,n.forIn=re,n.forOwn=oe,n.keys=ee,n.merge=E,n.uniq=q,n.each=C,n.unique=q,n.identity=M,n.indexOf=T,n.isArguments=b,n.isArray=k,n.isBoolean=w,n.isEqual=j,n.isFunction=O,n.isObject=P,n.isPlainObject=ie,n.isString=S,n.isUndefined=A,n.sortedIndex=N,n.noConflict=I,n.VERSION="1.2.0",n}var n="object"==typeof exports&&exports,r="object"==typeof module&&module&&module.exports==n&&module,o="object"==typeof global&&global;(o.global===o||o.window===o)&&(t=o);var i={},s=+new Date+"",a=200,u=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],c="[object Arguments]",p="[object Array]",f="[object Boolean]",l="[object Date]",_="[object Function]",d="[object Number]",h="[object Object]",y="[object RegExp]",g="[object String]",v={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},x=e();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(t._=x,define("lodash",[],function(){return x})):n&&!n.nodeType?r?(r.exports=x)._=x:n._=x:t._=x}({}),define("jsonp",["exceptions","json2","lodash"],function(t,e,n){var r;return r=function(){function r(){}return r.prototype.count=0,r.prototype.call=function(t,e,n){return this.jsonp(this.url(t,e),n)},r.prototype.url=function(t,e){return trak.io.protocol()+trak.io.host()+"/"+t+this.params(t,e)},r.prototype.params=function(t,r){var o,i,s,a;s=this.default_params(t),n.merge(s,r,function(t,e){return n.isArray(t)?n.uniq(t.concat(e)):void 0}),o=[];for(i in s)a=s[i],(n.isArray(a)||n.isObject(a))&&(a=e.stringify(a)),o.push(i+"="+encodeURIComponent(a));return"?"+o.join("&")},r.prototype.default_params=function(t){switch(t){case"identify":return{token:trak.io.api_token(),data:{distinct_id:trak.io.distinct_id(),properties:{}}};case"alias":return{token:trak.io.api_token(),data:{distinct_id:trak.io.distinct_id()}};case"track":return{token:trak.io.api_token(),data:{distinct_id:trak.io.distinct_id(),properties:{},channel:trak.io.channel(),context:trak.io.context()}};default:return{}}},r.prototype.callback=function(e,n){var r;if(!e||!e.status||"success"!==e.status)throw e.exception&&(r=t[e.exception.match(/\:\:([a-zA-Z0-9]+)$/)[1]])?new r(e.message,e.code,e.details,e):new t.Unknown(e.message,e.code,e.details,e);return n?n(e):void 0},r.prototype.noop=function(){},r.prototype.jsonp=function(t,e){var n,r,o,i,s,a,u;return a=1e4,s=document.getElementsByTagName("script")[0],r=this.count++,o=this,a&&(u=setTimeout(function(){return n(),o.callback({status:"error",exception:"TrakioAPI::Exceptions::Timeout",message:"The server failed to respond in time."})},a)),n=function(){return i.parentNode.removeChild(i),window["__trak"+r]=this.noop},o=this,window["__trak"+r]=function(t){return u&&clearTimeout(u),n(),o.callback(t,e)},t+=(~t.indexOf("?")?"&":"?")+"callback="+encodeURIComponent("__trak"+r),t=t.replace("?&","?"),i=document.createElement("script"),i.src=t,s.parentNode.insertBefore(i,s)},r}()}),define("io-query",["lodash"],function(){var t={};return{objectToQuery:function(e){var n=encodeURIComponent,r=[];for(var o in e){var i=e[o];if(i!=t[o]){var s=n(o)+"=";if(_.isArray(i))for(var a=0,u=i.length;u>a;++a)r.push(s+n(i[a]));else r.push(s+n(i))}}return r.join("&")},queryToObject:function(t){for(var e,n,r,o=decodeURIComponent,i=t.split("&"),s={},a=0,u=i.length;u>a;++a)if(r=i[a],r.length){var c=r.indexOf("=");0>c?(e=o(r),n=""):(e=o(r.slice(0,c)),n=o(r.slice(c+1))),"string"==typeof s[e]&&(s[e]=[s[e]]),_.isArray(s[e])?s[e].push(n):s[e]=n}return s}}}),!function(t,e){var n=function(){return n.get.apply(n,arguments)},r=n.utils={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},isPlainObject:function(t){return!!t&&"[object Object]"===Object.prototype.toString.call(t)},toArray:function(t){return Array.prototype.slice.call(t)},getKeys:Object.keys||function(t){var e=[],n="";for(n in t)t.hasOwnProperty(n)&&e.push(n);return e},escape:function(t){return(t+"").replace(/[,;"\\=\s%]/g,function(t){return encodeURIComponent(t)})},retrieve:function(t,e){return null==t?e:t}};n.defaults={},n.expiresMultiplier=86400,n.set=function(n,o,i){if(r.isPlainObject(n))for(var s in n)n.hasOwnProperty(s)&&this.set(s,n[s],o);else{i=r.isPlainObject(i)?i:{expires:i};var a=i.expires!==e?i.expires:this.defaults.expires||"",u=typeof a;"string"===u&&""!==a?a=new Date(a):"number"===u&&(a=new Date(+new Date+1e3*this.expiresMultiplier*a)),""!==a&&"toGMTString"in a&&(a=";expires="+a.toGMTString());var c=i.path||this.defaults.path;c=c?";path="+c:"";var p=i.domain||this.defaults.domain;p=p?";domain="+p:"";var f=i.secure||this.defaults.secure?";secure":"";t.cookie=r.escape(n)+"="+r.escape(o)+a+c+p+f}return this},n.remove=function(t){t=r.isArray(t)?t:r.toArray(arguments);for(var e=0,n=t.length;n>e;e++)this.set(t[e],"",-1);return this},n.empty=function(){return this.remove(r.getKeys(this.all()))},n.get=function(t,n){n=n||e;var o=this.all();if(r.isArray(t)){for(var i={},s=0,a=t.length;a>s;s++){var u=t[s];i[u]=r.retrieve(o[u],n)}return i}return r.retrieve(o[t],n)},n.all=function(){if(""===t.cookie)return{};for(var e=t.cookie.split("; "),n={},r=0,o=e.length;o>r;r++){var i=e[r].split("=");n[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return n},n.enabled=function(){if(navigator.cookieEnabled)return!0;var t="_"===n.set("_","_").get("_");return n.remove("_"),t},"function"==typeof define&&define.amd?define("cookie",[],function(){return n}):"undefined"!=typeof exports?exports.cookie=n:window.cookie=n}(document),define("trak",["jsonp","exceptions","io-query","cookie","lodash"],function(t,e,n,r,o){var i;return i=function(){function i(){this.io=this}return i.prototype.loaded=!0,i.prototype.Exceptions=e,i.prototype.cookie=r,i.prototype.initialize=function(t,e){var n;return this._api_token=t,null==e&&(e={}),this.protocol(e.protocol),e.host&&this.host(e.host),e.context&&this.context(e.context),e.channel&&this.channel(e.channel),this.distinct_id(e.distinct_id||null),this.root_domain(e.root_domain||null),e.auto_track_page_views!==!1&&(n=this,this.page_ready(function(){return n.page_view()})),this},i.prototype.initialise=function(){return this.initialize.apply(this,arguments)},i.prototype.page_ready_event_fired=!1,i.prototype.page_ready=function(t){var e,n,r,o;if(r=this,n=function(){return r.page_ready_event_fired?void 0:(r.page_ready_event_fired=!0,t())},e=function(){if(!this.page_ready_event_fired){try{document.documentElement.doScroll("left")}catch(t){return setTimeout(e,1),void 0}return n()}},"complete"===document.readyState)return n();if(document.addEventListener)return document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);if(document.attachEvent){document.attachEvent("onreadystatechange",n),window.attachEvent("onload",n),o=!1;try{o=null==window.frameElement}catch(i){}if(document.documentElement.doScroll&&o)return e()}},i.prototype.jsonp=new t,i.prototype.call=function(){return this.jsonp.call.apply(this.jsonp,arguments)},i.prototype.identify=function(){var t,e,n,r,o,i,s,a,u;o=this,t=this.sort_arguments(arguments,["string","object","function"]),n=t[0]||this.distinct_id(),i=t[1]||null,e=t[2]||null,s=0;for(a in i)u=i[a],s++;return r=function(t){return i?o.call("identify",{data:{distinct_id:n,properties:i}},e):e(t)},t[0]?o.alias(n,r):i&&s>0?r():e&&e({status:"unnecessary"}),this},i.prototype.alias=function(){var t,n,r,o,i;if(n=this.sort_arguments(arguments,["string","string","boolean","function"]),o=(n[1]?n[0]:void 0)||this.distinct_id(),t=n[1]?n[1]:n[0],i=null!==n[2]?n[2]:n[1]?!1:!0,r=n[3]||null,!t)throw new e.MissingParameter("Missing a required parameter.",400,"You must provide an alias, see http://docs.trak.io/alias.html");return t!==o?(this.call("alias",{data:{distinct_id:o,alias:t}},r),i&&this.distinct_id(t)):r&&r({status:"unnecessary"}),this},i.prototype.track=function(){var t,n,r,i,s,a,u;if(t=this.sort_arguments(arguments,["string","string","string","object","object","function"]),s=(t[2]?arguments[0]:void 0)||this.distinct_id(),a=t[2]?t[1]:t[0],r=(t[2]?t[2]:t[1])||this.channel(),u=t[3]||{},i=t[4]||{},i=o.merge(this.context(),i),n=t[5]||null,!a)throw new e.MissingParameter("Missing a required parameter.",400,"You must provide an event to track, see http://docs.trak.io/track.html");return this.call("track",{data:{distinct_id:s,event:a,channel:r,context:i,properties:u}},n),this},i.prototype.page_view=function(){var t,e,n,r;return t=this.sort_arguments(arguments,["string","string","function"]),r=t[0]||this.url(),n=t[1]||this.page_title(),e=t[2]||null,this.track("page_view",{url:r,page_title:n},e),this},i.prototype._protocol="https",i.prototype.protocol=function(t){return t&&(this._protocol=t),""+this._protocol+"://"},i.prototype._host="api.trak.io/v1",i.prototype.host=function(t){return t&&(this._host=t),this._host},i.prototype._current_context=!1,i.prototype.current_context=function(t,e){var n;return this._current_context||(this._current_context=(n=this.get_cookie("context"))?JSON.parse(n):{}),"object"==typeof t?o.merge(this._current_context,t):t&&e&&(this._current_context[t]=e),this.set_cookie("context",JSON.stringify(this._current_context)),this._current_context},i.prototype.default_context=function(){var t,e;return e=this.url(),t=this.referer(),{ip:null,user_agent:navigator.userAgent,page_title:this.page_title(),url:e,params:e.indexOf("?")>0?n.queryToObject(e.substring(e.indexOf("?")+1,e.length)):{},referer:t,referer_params:t.indexOf("?")>0?n.queryToObject(t.substring(t.indexOf("?")+1,t.length)):{}}},i.prototype.context=function(t,e){var n;return n={},o.merge(n,this.default_context(),this.current_context(t,e)),n},i.prototype.url=function(){return window.location.href},i.prototype.referer=function(){return document.referrer},i.prototype.page_title=function(){return document.title},i.prototype.hostname=function(){return document.location.hostname},i.prototype.url_params=function(){return window.location.search},i.prototype.get_distinct_id_url_param=function(){var t;return(t=this.url_params().match(/\?.*trak_distinct_id\=([^&]+).*/))?decodeURIComponent(t[1]):void 0},i.prototype._channel=!1,i.prototype.channel=function(t){return this._channel||(this._channel=this.get_cookie("channel"))||(this._channel=this.hostname()||"web_site"),t&&(this._channel=t,this.set_cookie("channel",t)),this._channel},i.prototype._api_token=null,i.prototype.api_token=function(){return this._api_token},i.prototype._distinct_id=null,i.prototype.distinct_id=function(t){return t&&(this._distinct_id=t),this._distinct_id||(this._distinct_id=this.get_distinct_id_url_param())||(this._distinct_id=this.get_cookie("id"))||(this._distinct_id=this.generate_distinct_id()),r.set(this.cookie_key("id"),this._distinct_id,{domain:this.root_domain()}),this._distinct_id},i.prototype.generate_distinct_id=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e,n;return e=0|16*Math.random(),n="x"===t?e:8|3&e,n.toString(16)})},i.prototype._root_domain=null,i.prototype.root_domain=function(t){return t||this._root_domain||(this._root_domain=this.get_root_domain()),t&&(this._root_domain=t),this._root_domain},i.prototype.get_root_domain=function(){var t,e;if(this.hostname().match(/[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$/i)||"localhost"===this.hostname())return this.hostname();for(e=this.hostname().split("."),t=e.pop();e.length>0&&!this.can_set_cookie({domain:t});)t=""+e.pop()+"."+t;return t},i.prototype.set_cookie=function(t,e){return r.set(this.cookie_key(t),e)},i.prototype.get_cookie=function(t){return r.get(this.cookie_key(t))},i.prototype.can_set_cookie=function(t){return r.set(this.cookie_key("foo"),""),r.set(this.cookie_key("foo"),"",t),r.set(this.cookie_key("foo"),"bar",t),"bar"===r.get(this.cookie_key("foo"))},i.prototype.cookie_key=function(t){return"_trak_"+this.api_token()+"_"+t},i.prototype.sort_arguments=function(t,e){var n,r,o,i,s;for(t=Array.prototype.slice.call(t),n=[],o=t.shift(),i=0,s=e.length;s>i;i++)r=e[i],r===typeof o?(n.push(o),o=t.shift()):n.push(null);return n},i}()}),define("trak.io",["trak","lodash","cookie"],function(t,e,n){var r,o,i,s;if(!window.trak||!window.trak.loaded){for(s=new t,i=window.trak,window.trak=s;i&&i.length>0;)r=i.shift(),o=r.shift(),s.io[o]&&s.io[o].apply(s.io,r);return n.defaults.expires=3650,n.defaults.path="/"}}),require(["trak.io"])})();